---
title: "Microsoft program mot skadlig kod för Azure | Microsoft Docs"
description: "Den här artikeln innehåller en översikt över arkitekturen i Microsoft Antimalware för Azure, inklusive scenarier som stöds och konfigurationer för att aktivera, konfigurera och distribuera skydd för Azure-molntjänster och virtuella datorer. Vi beskriver grundläggande konfiguration, hantering och övervakning av funktioner som är tillgängligt via Microsoft Azure service management API, PowerShell-skript, Azure-portalen och Visual Studio."
services: security
documentationcenter: na
author: YuriDio
manager: swadhwa
editor: 
ms.assetid: 265683c8-30d7-4f2b-b66c-5082a18f7a8b
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/01/2017
ms.author: yurid
ms.openlocfilehash: 71ecb822c5e8234e8c8db4e60169e8dd3a6de81f
ms.sourcegitcommit: d41d9049625a7c9fc186ef721b8df4feeb28215f
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 11/02/2017
---
# <a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>Microsoft programvara mot skadlig programvara för Azure molntjänster och virtuella maskiner
Moderna hotbilden i grunden för molnmiljöer är mycket dynamisk öka trycket på företag IT cloud-prenumeranter att upprätthålla effektiv skydd för att uppfylla krav efterlevnad och säkerhet. Microsoft Antimalware för Azure är ledigt realtidsskydd funktion som hjälper dig att identifiera och ta bort virus, spionprogram och annan skadlig programvara med konfigurerbara aviseringar när känd skadlig eller oönskad programvara försöker installera sig själva eller köras på Azure-system.

Lösningen bygger på samma plattform för program mot skadlig kod som Microsoft Security Essentials \[mus\], Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune och Windows Defender för Windows 8.0 och senare. Microsoft Antimalware för Azure är en enskild agent lösning för program och klient-miljöer är avsedd att köras i bakgrunden utan mänsklig inblandning. Du kan distribuera skydd utifrån behoven i din programbelastningar, med antingen grundläggande secure-som-standard eller avancerad anpassad konfiguration, inklusive övervakning av program mot skadlig kod.

När du distribuerar och aktivera Microsoft Antimalware för Azure för dina program, finns följande grundläggande funktioner:

* **Realtidsskydd** -övervakar aktiviteten i Cloud Services och på virtuella datorer för att identifiera och blockera skadlig kod körning.
* **Schemalagd genomsökning** -regelbundet utför riktade genomsökning för att upptäcka skadlig kod, inklusive program som körs aktivt.
* **Korrigering av skadlig kod** - automatiskt vidtar åtgärder på upptäckt skadlig kod, till exempel ta bort eller sätta i karantän skadliga filer och rensa skadliga registerposter.
* **Signaturuppdateringar** - automatiskt installerar de senaste signaturerna (virusdefinitioner av) för att skyddet uppdaterad på en förbestämd frekvens.
* **Motorn för program mot skadlig kod uppdaterar** – automatiskt uppdaterar Microsoft Antimalware-motorn.
* **Uppdateringar för program mot skadlig kod plattform** – automatiskt uppdaterar Microsoft Antimalware-plattformen.
* **Aktivt skydd** – rapporterar telemetri metadata om identifierade hot och misstänkta resurser till Microsoft Azure för att säkerställa snabba svar på växande hotbild, samt aktivera realtidsskydd synkron signatur leverans via Microsoft Active Protection System (MAPS).
* **Exempel reporting** – ger och rapporterar prover till tjänsten Microsoft Antimalware för att förbättra tjänsten och aktivera felsökning.
* **Undantag** – gör att program och administratörer kan konfigurera vissa filer, processer, och enheter för att utesluta dem från skyddet och skanning för prestanda och/eller andra orsaker.
* **Program mot skadlig kod händelseinsamling** – registrerar tjänstens hälsa för program mot skadlig kod, misstänkta aktiviteter och åtgärder som vidtagits i händelseloggen för operativsystemet och samlar in dem i kundens Azure Storage-konto.

> [!NOTE]
> Microsoft Antimalware kan också distribueras med hjälp av Azure Security Center. Läs [installera Endpoint Protection i Azure Security Center](../security-center/security-center-install-endpoint-protection.md) för mer information.
>
>

## <a name="architecture"></a>Arkitektur
Microsoft Antimalware för Azure lösningen innehåller Microsoft Antimalware Client och tjänsten klassiska distributionsmodellen för program mot skadlig kod, Antimalware PowerShell-cmdlets och tillägg för Azure-diagnostik. Microsoft Antimalware lösning stöds på Windows Server 2008 R2, Windows Server 2012 och Windows Server 2012 R2-operativsystem. Den stöds inte på Windows Server 2008-operativsystem och också stöds inte i Linux. Stöd för Windows Server 2016 med Defender har släppts kan du läsa mer om den här uppdateringen [här](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

Microsoft Antimalware Client och tjänsten installeras som standard i ett inaktiverat tillstånd i alla stöds Azure gäst operativsystem i Cloud Services-plattformen. Tjänsten Microsoft Antimalware Client och installeras inte som standard i plattformen för virtuella datorer och är tillgänglig som en valfri funktion via Azure portal och konfiguration av virtuell dator för Visual Studio under Security Extensions.

När du använder Azure App Service, den underliggande tjänsten som är värd för har webbprogrammet Microsoft Antimalware är aktiverat. Detta används för att skydda Azure App Service-infrastruktur och körs inte på kunden innehåll.

### <a name="microsoft-antimalware-workflow"></a>Arbetsflöde för Microsoft-program mot skadlig kod
Azure-tjänst-administratör kan aktivera program mot skadlig kod för Azure med en fördefinierad eller anpassad konfiguration för virtuella datorer och molntjänster med hjälp av följande alternativ:

* Virtuella datorer – i Azure-portalen under **Security Extensions**
* Virtuella datorer – med konfigurationen av Visual Studio-virtuella datorer i Server Explorer
* Virtuella datorer och molntjänster – med hjälp av det program mot skadlig kod [klassiska distributionsmodellen](https://msdn.microsoft.com/library/azure/ee460799.aspx)
* Virtuella datorer och molntjänster – med hjälp av program mot skadlig kod PowerShell-cmdlets

Azure-portalen eller PowerShell-cmdlets push-tilläggsfilen för program mot skadlig kod till Azure system vid en förbestämd fast plats. Azure-Gästagent (eller Fabric-Agent) startar tillägget program mot skadlig kod, tillämpa konfigurationsinställningarna för program mot skadlig kod som angavs som indata. Det här steget aktiverar antivirustjänsten med antingen standard eller anpassade inställningar. Om ingen anpassad konfiguration anges, aktiveras antivirustjänsten med standardinställningarna. Referera till den *konfiguration för program mot skadlig kod* i avsnittet den [Microsoft Antimalware för Azure-kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure-molntjänster och virtuella datorer kodexempel") för mer information.

När körs, Microsoft Antimalware klienten laddar ned de senaste definitionerna för protection-motorn och signatur från Internet och läser in dem på Azure-datorn. Tjänsten Microsoft Antimalware skriver tjänstrelaterade händelser till systemloggen för OS händelser under händelsekälla ”Microsoft Antimalware”. Hälsotillståndet för klienten för program mot skadlig kod, skydd och reparation status, nya och gamla konfigurationsinställningar, uppdateringar och signatur definitioner och andra innehåller händelser.

Du kan aktivera övervakning av program mot skadlig kod för din tjänst i molnet eller virtuell dator som har skadlig kod händelse logghändelser skrivs som tillverkas till Azure storage-konto. Antimalware Service använder tillägget för Azure-diagnostik för att samla in händelser för program mot skadlig kod från Azure systemet till tabeller i kundens Azure Storage-konto.

Arbetsflöde för distribution inklusive konfigurationssteg och alternativ som stöds för ovannämnda scenarier dokumenteras i [scenarier för distribution av program mot skadlig kod](#_Antimalware_Deployment_Scenarios) i det här dokumentet.

![Microsoft Antimalware i Azure](./media/azure-security-antimalware/sec-azantimal-fig1.PNG)

> [!NOTE]
> Du kan dock använda Powershell/API: er och Azure Resource Manager-mallar för att distribuera virtuella datorer med tillägget Microsoft skadlig kod.  Du kan använda python exempelskript för att installera ett tillägg på en virtuell dator som redan körs, *vmssextn.py* finns [här](https://github.com/gbowerman/vmsstools). Detta skript hämtar befintliga tillägget config på Scale Set och lägger till ett filnamnstillägg till listan över befintliga tillägg på den Skalningsuppsättningar.
>
>

### <a name="default-and-custom-antimalware-configuration"></a>Standard- och anpassade program mot skadlig kod konfiguration
Standardinställningarna används för att aktivera program mot skadlig kod för Azure Cloud Services eller virtuella datorer när du inte anger inställningar för anpassad konfiguration. Standardinställningarna har redan är optimerad för att köra i Azure-miljön. Alternativt kan kan du anpassa dessa standardinställningar konfiguration som krävs för din Azure-program eller service-distributionen och använda dem för andra scenarier för distribution.

> [!NOTE]
> Som standard Microsoft Antimalware-användargränssnittet på Azure Resource Manager är inaktiverad [cleanuppolicy.xml](https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/) att kringgå det här felmeddelandet stöds inte. Information om hur du skapar en anpassad princip [att aktivera Microsoft program mot skadlig kod användargränssnittet på Azure Resource Manager virtuella datorer efter distribution](https://blogs.msdn.microsoft.com/azuresecurity/2016/03/09/enabling-microsoft-antimalware-user-interface-post-deployment/).
>
>

I följande tabell sammanfattas konfigurationsinställningarna som är tillgängliga för program mot skadlig kod-tjänsten. Standardinställningarna är markerade under kolumnen ”Default” nedan.

![Tabell 1](./media/azure-security-antimalware/sec-azantimal-tb18.PNG)

## <a name="antimalware-deployment-scenarios"></a>Scenarier för distribution av program mot skadlig kod
I det här avsnittet beskrivs scenarier för att aktivera och konfigurera program mot skadlig kod, inklusive övervakning för Azure-molntjänster och virtuella datorer.

### <a name="virtual-machines---enable-and-configure-antimalware"></a>Virtuella datorer – aktivera och konfigurera program mot skadlig kod
**Distribution med hjälp av Azure Portal**

Om du vill aktivera tjänsten program mot skadlig kod, klickar du på **Lägg till** på bladet tillägg väljer **Microsoft Antimalware** Klicka på ny resursbladet **skapa** på bladet Microsoft Antimalware. Klicka på **skapa** utan att mata in alla konfigurationsvärden för att aktivera program mot skadlig kod med standardinställningarna eller ange konfigurationsinställningar för program mot skadlig kod för den virtuella datorn som konfigurerats som visas i bild 2 nedan. Mer information finns i **knappbeskrivningar** som ingår i varje Konfigurationsinställningen på bladet Lägg till tillägget se de konfigurationer som stöds.

![Virtuella datorns konfigurationsinställningar för Microsoft Antimalware](./media/azure-security-antimalware/sec-azantimal-fig2.PNG)

**Distribution med Azure-portalen**

Följ stegen nedan för att aktivera och konfigurera Microsoft Antimalware för virtuella datorer i Azure med Azure-portalen när etablera en virtuell dator:

1. Logga in på Azure-portalen på <https://portal.azure.com>

2. Om du vill skapa en ny virtuell dator klickar du på **ny**, **Compute**, **virtuella** **datorn**, **från galleriet** (Använd inte Snabbregistrering) enligt nedan:

![Ny virtuell dator](./media/azure-security-antimalware/sec-azantimal-fig3.PNG)

3 väljer den **Microsoft Windows Server** bild på den **Välj en bild** sidan.

4. Klicka på högerpilen och ange konfigurationen för virtuella datorn.

5. Kontrollera den **Microsoft Antimalware** kryssrutan under **Security Extensions** på konfigurationssidan för virtuell dator.

6 Klicka på knappen Skicka för att aktivera och konfigurera Microsoft Antimalware för virtuella datorer i Azure med standardinställningarna.

![Konfiguration av virtuell dator](./media/azure-security-antimalware/sec-azantimal-fig4.PNG)

**Distribution med virtuella Datorkonfiguration för Visual Studio**

Aktivera och konfigurera tjänsten Microsoft Antimalware med hjälp av Visual Studio:

1. ansluta till Microsoft Azure i Visual Studio.

2. Välj den virtuella datorn i den **virtuella datorer** nod i **Server Explorer**

![Konfiguration av virtuell dator i Visual Studio](./media/azure-security-antimalware/sec-azantimal-fig5.PNG)

3 Högerklicka på **konfigurera** att visa konfigurationssidan för virtuell dator

4 Välj **Microsoft Antimalware** tillägget från den nedrullningsbara listan under **installerat tillägg** och på **Lägg till** att konfigurera med standardkonfigurationen för program mot skadlig kod.

![Installerade tilläggen](./media/azure-security-antimalware/sec-azantimal-fig6.PNG)

5 Välj (Markera) det program mot skadlig kod tillägg i listan över installerade tilläggen för att anpassa standardkonfigurationen för program mot skadlig kod, och klicka på **konfigurera**.

6 Ersätt standardkonfigurationen för program mot skadlig kod med anpassade konfigurationen i JSON-format som stöds i den **offentliga konfiguration** textrutan och klicka på OK.

7. klickar du på den **uppdatering** för att push-konfigurationsuppdateringar till den virtuella datorn.

![Tillägg för konfiguration av virtuell dator](./media/azure-security-antimalware/sec-azantimal-fig7.PNG)

**Obs:** konfigurationen av virtuella datorer för Visual Studio för program mot skadlig kod stöder endast konfigurationen i JSON-format. Mallen Antimalware JSON configuration inställningar ingår i den [Microsoft program mot skadlig kod för Azure - kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure - kodexempel"), visar stöds konfigurationsinställningarna för program mot skadlig kod.

**Med hjälp av PowerShell-cmdlets för distribution**

En Azure-program eller tjänst kan aktivera och konfigurera Microsoft Antimalware för virtuella datorer i Azure med PowerShell-cmdlets.

Aktivera och konfigurera Microsoft för program mot skadlig kod med PowerShell-cmdlets för program mot skadlig kod:

1. Konfigurera din miljö för PowerShell - dokumentationen på <https://github.com/Azure/azure-powershell>
2. Använd cmdlet Set-AzureVMMicrosoftAntimalwareExtension program mot skadlig kod för att aktivera och konfigurera Microsoft Antimalware för din virtuella dator som beskrivs i <http://msdn.microsoft.com/library/azure/dn771718.aspx>

**Obs:** JSON-formatkonfigurationen endast har stöd för virtuella datorer i Azure-konfiguration för program mot skadlig kod. Mallen Antimalware JSON configuration inställningar ingår i den [Microsoft program mot skadlig kod för Azure - kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure - kodexempel"), visar stöds konfigurationsinställningarna för program mot skadlig kod.

### <a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>Aktivera och konfigurera program mot skadlig kod med PowerShell-cmdlets
En Azure-program eller tjänst kan aktivera och konfigurera Microsoft Antimalware för Azure Cloud Services med PowerShell-cmdlets. Observera att programmet Microsoft Antimalware är installerat i ett inaktiverat tillstånd i Cloud Services-plattformen och kräver en åtgärd med ett Azure-program att aktivera den.

Aktivera och konfigurera Microsoft Antimalware med PowerShell-cmdlets:

1. Konfigurera din miljö för PowerShell - dokumentationen på <https://github.com/Azure/azure-sdk-tools#get-started>
2. Använd cmdlet Set-AzureServiceAntimalwareExtension program mot skadlig kod för att aktivera och konfigurera Microsoft Antimalware för din tjänst i molnet som beskrivs i <http://msdn.microsoft.com/library/azure/dn771718.aspx>

Mallen Antimalware XML configuration inställningar ingår i den [Microsoft program mot skadlig kod för Azure - kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure - kodexempel"), visar stöds konfigurationsinställningarna för program mot skadlig kod.

### <a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>Molntjänster och virtuella datorer - konfigurationen med hjälp av PowerShell-cmdlets
En Azure-program eller tjänst kan hämta Microsoft Antimalware-konfiguration för molntjänster och virtuella datorer med hjälp av PowerShell-cmdlets.

Att hämta Microsoft Antimalware-konfigurationen med hjälp av PowerShell-cmdlets:

1. Konfigurera din miljö för PowerShell - dokumentationen på <https://github.com/Azure/azure-sdk-tools#get-started>
2. **För virtuella datorer**: Använd cmdleten Get-AzureVMMicrosoftAntimalwareExtension program mot skadlig kod att hämta konfigurationen för program mot skadlig kod som beskrivs i <http://msdn.microsoft.com/library/azure/dn771719.aspx>
3. **För molntjänster**: Använd cmdleten Get-AzureServiceAntimalwareConfig program mot skadlig kod att hämta konfigurationen för program mot skadlig kod som beskrivs i <http://msdn.microsoft.com/library/azure/dn771722.aspx>

### <a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>Ta bort program mot skadlig kod konfigurationen med hjälp av PowerShell-cmdlets
En Azure-program eller tjänst kan ta bort konfiguration för program mot skadlig kod och alla associerade program mot skadlig kod övervakningskonfigurationen de relevanta Azure program mot skadlig kod och diagnostik tillägg som är associerade med Molntjänsten eller den virtuella datorn.

Ta bort Microsoft Antimalware med PowerShell-cmdlets:

1. Konfigurera din miljö för PowerShell - dokumentationen på<Link Broken>
2. **För virtuella datorer**: Använd cmdleten Remove-AzureVMMicrosoftAntimalwareExtension program mot skadlig kod som beskrivs i <http://msdn.microsoft.com/library/azure/dn771720.aspx>
3. **För molntjänster:** Använd cmdleten Remove-AzureServiceAntimalwareExtension program mot skadlig kod som beskrivs i <http://msdn.microsoft.com/library/azure/dn771717.aspx>

Att **aktivera** händelseinsamling för program mot skadlig kod för en virtuell dator med hjälp av Azure Preview Portal:

1. Klicka på någon del av övervakning linsen i bladet för virtuella datorer
2. Klicka på kommandot diagnostik på mått bladet
3. Välj **Status** ON och markera alternativet för Windows-händelse
4. . Du kan välja att avmarkera alla andra alternativ i listan eller lämna dem aktiveras per dina programbehov för tjänsten.
5. Program mot skadlig kod kategorier i ”Error”, ”varning”, ”information”, osv., fångas i Azure Storage-konto.

Händelser för program mot skadlig kod samlas in från händelseloggarna i Windows system till ditt Azure Storage-konto. Du kan konfigurera Lagringskontot för den virtuella datorn att samla in händelser för program mot skadlig kod genom att välja lämplig storage-konto.

![Mått och diagnostik](./media/azure-security-antimalware/sec-azantimal-fig8.PNG)

> [!NOTE]
> Mer information om hur du diagnostik loggning för program mot skadlig kod Azure [aktivera loggning diagnostik för program mot skadlig kod Azure](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).
>
>

### <a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>Aktivera och konfigurera övervakning av program mot skadlig kod med hjälp av powerShell-cmdlets
Du kan aktivera insamling av Microsoft Antimalware händelser för din molntjänst eller en virtuell dator med Azure-diagnostik via Antimalware PowerShell-cmdletar. Azure-diagnostik-tillägget kan konfigureras för att samla in händelser från källan för händelseloggning System ”Microsoft Antimalware” till Azure Storage-konto. Program mot skadlig kod kategorier i ”Error”, ”varning”, ”information”, osv., fångas i Azure Storage-konto.

Så här aktiverar händelseinsamling för program mot skadlig kod till din Azure Storage-konto med hjälp av PowerShell-cmdlets:

1. Konfigurera din miljö för PowerShell - avser <https://github.com/Azure/azure-sdk-tools#get-started>
2. **För virtuella datorer** -Använd cmdleten Set-AzureVMMicrosoftAntimalwareExtension program mot skadlig kod med övervakning på alternativet som beskrivs i <http://msdn.microsoft.com/library/azure/dn771716.aspx>
3. **För molntjänster** -Använd cmdleten Set-AzureServiceAntimalwareExtension program mot skadlig kod med övervakning på alternativet som beskrivs i <http://msdn.microsoft.com/library/azure/dn771718.aspx>

Du kan visa program mot skadlig kod rådata händelser genom att titta på den *WADWindowsEventLogsTable* tabellen i ditt Azure Storage-konto som du har konfigurerat för att aktivera övervakning av program mot skadlig kod. Detta kan vara användbart för att verifiera att program mot skadlig kod händelseinsamling fungerar, inklusive få insyn i program mot skadlig kod-tjänstens hälsa. Mer information, inklusive exempelkod för extrahering av program mot skadlig kod händelser från ditt lagringskonto finns i [Microsoft program mot skadlig kod för Azure - kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure - kodexempel").
