---
title: Microsoft Antimalware för Azure | Microsoft Docs
description: Den här artikeln innehåller en översikt över arkitekturen för Microsoft Antimalware för Azure, inklusive scenarier som stöds och konfigurationer för att aktivera, konfigurera och distribuera protection för Azure Cloud Services och virtuella datorer. Vi täcker grundläggande konfiguration, hantering och övervakning av funktioner som är tillgängliga via Microsoft Azure service management API, PowerShell-skript, Azure-portalen och Visual Studio.
services: security
documentationcenter: na
author: barclayn
manager: mbaldwin
editor: ''
ms.assetid: 265683c8-30d7-4f2b-b66c-5082a18f7a8b
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/27/2018
ms.author: barclayn
ms.openlocfilehash: c246c79a34dd51e7cfdb1d97a1c784e37a757eac
ms.sourcegitcommit: 2ad510772e28f5eddd15ba265746c368356244ae
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/28/2018
ms.locfileid: "43123802"
---
# <a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>Microsoft programvara mot skadlig programvara för Azure molntjänster och virtuella maskiner

Microsoft Antimalware för Azure är en kostnadsfri realtidsskydd som hjälper dig att identifiera och ta bort virus, spionprogram och annan skadlig programvara. Den genererar aviseringar när känd skadlig eller oönskad programvara försöker installera sig själva eller köras på din Azure-system.

Lösningen bygger på samma plattform för program mot skadlig kod som Microsoft Security Essentials \[MSE\], Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune och Windows Defender. Microsoft Antimalware för Azure är en enskild agent-lösning för program och klient-miljöer som har utformats för att köras i bakgrunden utan mänsklig inblandning. Skyddet kan distribueras baserat på dina behov för programbelastningar, med antingen grundläggande säker som standard eller avancerad anpassad konfiguration, bland annat övervakning av program mot skadlig kod.

När du distribuerar och aktivera Microsoft Antimalware för Azure för dina program, finns följande huvudfunktioner:

* **Realtidsskydd** -övervakar aktiviteten i Cloud Services och på virtuella datorer för att identifiera och blockera körning av skadlig kod.
* **Schemalagd genomsökning** -genomsökningar regelbundet för att identifiera skadlig kod, däribland program som körs aktivt.
* **Korrigering av skadlig kod** – automatiskt agerar på identifierad skadlig kod, till exempel ta bort eller placera det i karantän skadliga filer och rensar skadliga registerposter.
* **Signaturuppdateringar** – automatiskt installerar de senaste signaturerna (virusdefinitioner av) för att säkerställa skydd är uppdaterad på en förbestämd frekvens.
* **Motorn för program mot skadlig kod uppdaterar** – automatiskt uppdaterar Microsoft Antimalware-motorn.
* **Plattformen för program mot skadlig kod uppdaterar** – automatiskt uppdaterar Microsoft Antimalware-plattformen.
* **Aktivt skydd** – rapporterar telemetri metadata om identifierade hot och misstänkta resurser till Microsoft Azure för att se till att snabbt svar på den växande hotbilden, samt aktivera i realtid synkron signatur analysleverans via Microsoft Active Protection System (MAPS).
* **Exempel reporting** – ger och rapporterar exempel till tjänsten Microsoft Antimalware för att förfina tjänsten och aktivera felsökning.
* **Undantag** – gör att program och administratörer kan konfigurera undantag för filer, processer och enheter.  
* **Händelseinsamling för program mot skadlig kod** – registrerar den tjänstehälsa för program mot skadlig kod, misstänkta aktiviteter och åtgärder som vidtagits i händelseloggen för operativsystemet och samlar in dem till kundens Azure Storage-konto.

> [!NOTE]
> Microsoft Antimalware kan också distribueras med hjälp av Azure Security Center. Läs [installera Endpoint Protection i Azure Security Center](../security-center/security-center-install-endpoint-protection.md) för mer information.

## <a name="architecture"></a>Arkitektur

Microsoft Antimalware för Azure innehåller Microsoft Antimalware Client och tjänsten, klassisk distributionsmodell för program mot skadlig kod, Antimalware PowerShell-cmdletar och Azure Diagnostics-tillägget. Microsoft Antimalware stöds på Windows Server 2008 R2, Windows Server 2012 och Windows Server 2012 R2-operativsystem. Den stöds inte på Windows Server 2008-operativsystem och också stöds inte i Linux.

Microsoft Antimalware Client och tjänsten installeras som standard i ett inaktiverat tillstånd för alla gästoperativsystem som stöds Azure operativsystemet i Cloud Services-plattformen. Microsoft Antimalware Client och tjänsten är inte installerad som standard i plattformen för virtuella datorer och är tillgänglig som en valfri funktion via Azure portal och Visual Studio-virtuella datorkonfigurationen under säkerhetstillägg.

När du använder Azure App Service, den underliggande tjänsten som är värd för har webbappen Microsoft Antimalware är aktiverat. Detta används för att skydda Azure App Service-infrastrukturen och kan inte köras i kund-innehåll.

> [!NOTE]
> Windows Defender är den inbyggda program mot skadlig kod aktiverat i Windows Server 2016. Windows Defender-gränssnittet också är aktiverat som standard på en Windows Server 2016 SKU: er [mer information finns här](https://docs.microsoft.com/windows/threat-protection/windows-defender-antivirus/windows-defender-antivirus-on-windows-server-2016). Tillägget Azure virtuella datorer mot skadlig kod kan fortfarande läggas till en Windows Server 2016 Azure-dator med Windows Defender, men i det här scenariot tillägget gäller alla valfria [konfigurationsprinciper](https://gallery.technet.microsoft.com/Antimalware-For-Azure-5ce70efe) som ska användas av Windows Defender, den tillägget distribuerar inte några ytterligare program mot skadlig kod-tjänster.
> Du kan läsa mer om den här uppdateringen [här](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

### <a name="microsoft-antimalware-workflow"></a>Arbetsflöde för Microsoft-program mot skadlig kod

Azure service-administratör kan aktivera program mot skadlig kod för Azure med en fördefinierad eller anpassad konfiguration för dina virtuella datorer och molntjänster med hjälp av följande alternativ:

* Virtuella datorer – i Azure-portalen under **säkerhetstillägg**
* Virtuella datorer – med hjälp av Visual Studio VM-konfigurationen i Server Explorer
* Virtuella datorer och molntjänster – med det program mot skadlig kod [klassiska distributionsmodellen](https://msdn.microsoft.com/library/azure/ee460799.aspx)
* Virtuella datorer och molntjänster – med hjälp av program mot skadlig kod PowerShell-cmdletar

Azure-portalen eller PowerShell-cmdletar kan du skicka tilläggsfilen för program mot skadlig kod till Azure-systemet vid en förbestämd fast plats. Azure-Gästagentversionen (eller Fabric-Agent) startar tillägget mot skadlig kod, tillämpa de konfigurationsinställningar för program mot skadlig kod som angetts som indata. Det här steget aktiverar antivirustjänsten med antingen standard eller anpassade konfigurationsinställningar. Om ingen anpassad konfiguration har angetts och aktiveras antivirustjänsten med standardinställningarna. Referera till den *program mot skadlig kod configuration* i avsnittet den [Microsoft Antimalware för Azure – kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure Cloud Services och virtuella datorer kodexempel")för mer information.

När du kör, Microsoft Antimalware klienten laddar ned de senaste definitionerna för protection-motorn och signatur från Internet och läser in dem på Azure-systemet. Tjänsten Microsoft Antimalware skriver tjänstrelaterade händelser till systemloggen för OS händelser under ”Microsoft Antimalware” händelsekälla. Händelser är hälsotillståndet för klienten för program mot skadlig kod, skydd och reparation status, nya och gamla konfigurationsinställningar, uppdateringar och signatur definitioner och andra.

Du kan aktivera övervakning av program mot skadlig kod för din molntjänst eller virtuell dator ha program mot skadlig kod händelse logghändelser skrivs som de produceras till Azure storage-kontot. Antimalware Service använder Azure Diagnostics-tillägget för att samla in händelser för program mot skadlig kod från Azure-systemet till tabeller i kundens Azure Storage-konto.

Arbetsflödet, inklusive konfigurationssteg och alternativ som stöds för scenarier ovan finns dokumenterade i [distributionsscenarier för program mot skadlig kod](#antimalware-deployment-scenarios) i det här dokumentet.

![Microsoft Antimalware i Azure](./media/azure-security-antimalware/sec-azantimal-fig1.PNG)

> [!NOTE]
> Du kan dock använda Powershell/API: er och Azure Resource Manager-mallar för att distribuera Virtual Machine Scale Sets med tillägget Microsoft Anti-Malware.  Du kan använda exemplet python-skriptet för att installera ett tillägg på en redan aktiv virtuell dator, [vmssextn.py](https://github.com/gbowerman/vmsstools). Detta skript hämtar befintliga tillägget konfig på Skalningsuppsättningen och lägga till ett filnamnstillägg till listan över befintliga tillägg på VM-Skalningsuppsättningar.
>
>

### <a name="default-and-custom-antimalware-configuration"></a>Standard och anpassade program mot skadlig kod konfiguration

Standardinställningarna används för att aktivera program mot skadlig kod för Azure Cloud Services eller virtuella datorer om du inte anger anpassade konfigurationsinställningar. Standardinställningarna har redan är optimerad för att köra i Azure-miljön. Du kan också anpassa dessa standardinställningar för konfigurationen som krävs för din Azure-program eller service-distributionen och använda dem för andra scenarier.

> [!NOTE]
> Som standard i användargränssnittet för Microsoft Antimalware på Azure Resource Manager är inaktiverad, [cleanuppolicy.xml](https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/) att kringgå det här felmeddelandet stöds inte. Information om hur du skapar en anpassad princip [aktiverar användargränssnittet för Microsoft Antimalware på Azure Resource Manager virtuella datorer efter distribution](https://blogs.msdn.microsoft.com/azuresecurity/2016/03/09/enabling-microsoft-antimalware-user-interface-post-deployment/).
>
>

I följande tabell sammanfattas konfigurationsinställningarna för tjänsten för program mot skadlig kod. Standardinställningarna är markerade under kolumnen ”standard” nedan.

![Tabell 1](./media/azure-security-antimalware/sec-azantimal-tb18.PNG)

## <a name="antimalware-deployment-scenarios"></a>Distributionsscenarier för program mot skadlig kod

Scenarier för att aktivera och konfigurera program mot skadlig kod, inklusive övervakning för Azure Cloud Services och virtuella datorer, beskrivs i det här avsnittet.

### <a name="virtual-machines---enable-and-configure-antimalware"></a>Virtual machines – aktivera och konfigurera program mot skadlig kod

#### <a name="deployment-while-creating-a-vm-using-the-azure-portal"></a>Distributionen när skapar en virtuell dator med Azure-portalen

Aktivera och konfigurera Microsoft Antimalware för Azure Virtual Machines med hjälp av Azure-portalen samtidigt etablera en virtuell dator genom att följa stegen nedan:

1. Logga in på Azure Portal på <https://portal.azure.com>.
2. Skapa en ny virtuell dator, gå till **virtuella datorer**väljer **Lägg till**, och välj **Windows Server**.
3. Välj versionen av Windows server som du vill använda.
4. Välj **Skapa**.
    ![Skapa virtuell dator](./media/azure-security-antimalware/create-vm.PNG)
5. Ange en **namn**, **användarnamn**, **lösenord**, och skapa en ny resursgrupp eller välj en befintlig resursgrupp.
6. Välj **OK**.
7. Välj en vm-storlek.
8. I nästa avsnitt, göra lämpliga val för dina behov väljer du den **tillägg** avsnittet.
9. Välj **Lägg till tillägg**
10. Under **ny resurs**, Välj **Microsoft Antimalware**.
11. Välj **Skapa**
12. I den **installera tillägget** avsnittsfilen, platser och processundantag kan konfigureras samt andra alternativ för sökning. Välj **OK**.
13. Välj **OK**.
14. I den **inställningar** väljer **Ok**.
15. I den **skapa** väljer **Ok**.

#### <a name="deployment-using-the-visual-studio-virtual-machine-configuration"></a>Distribution med Visual Studio VM-konfiguration

Aktivera och konfigurera tjänsten Microsoft Antimalware med hjälp av Visual Studio:

1. Ansluta till Microsoft Azure i Visual Studio.

2. Välj den virtuella datorn i den **virtuella datorer** nod i **Server Explorer**

   ![Konfiguration av virtuell dator i Visual Studio](./media/azure-security-antimalware/sec-azantimal-fig5.PNG)

3. Högerklicka på **konfigurera** att visa konfigurationssidan för virtuell dator

4. Välj **Microsoft Antimalware** tillägget från den nedrullningsbara listan under **installerat tillägg** och klicka på **Lägg till** att konfigurera med standardkonfigurationen för program mot skadlig kod.
    ![Installerade tillägg](./media/azure-security-antimalware/sec-azantimal-fig6.PNG)
5. Välj (Markera) det program mot skadlig kod tillägg i listan över installerade tillägg för att anpassa standardkonfigurationen för program mot skadlig kod, och klicka på **konfigurera**.

6. Ersätt standardkonfigurationen för program mot skadlig kod med anpassade konfigurationen i JSON-format som stöds i den **offentliga konfiguration** textrutan och klicka på OK.

7. Klicka på den **uppdatering** knappen för att skicka uppdateringarna för till den virtuella datorn.

    ![Tillägg för VM-konfiguration](./media/azure-security-antimalware/sec-azantimal-fig7.PNG)

> [!NOTE]
>Visual Studio-VM-konfigurationen för program mot skadlig kod stöder enbart konfiguration i JSON-format. Antimalware JSON-konfigurationsmall för inställningar som ingår i den [Microsoft program mot skadlig kod för Azure - kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure - kodexempel"), som visar stöds Inställningar för program mot skadlig kod.

#### <a name="deployment-using-powershell-cmdlets"></a>Distribution med hjälp av PowerShell-cmdletar

En Azure-program eller tjänst kan aktivera och konfigurera Microsoft Antimalware för Azure Virtual Machines med hjälp av PowerShell-cmdletar.

Aktivera och konfigurera Microsoft program mot skadlig kod med hjälp av PowerShell-cmdletar för program mot skadlig kod:

1. Konfigurera din miljö för PowerShell - dokumentationen på <https://github.com/Azure/azure-powershell>
2. Använd den [cmdlet Set-AzureVMMicrosoftAntimalwareExtension program mot skadlig kod](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) aktivera och konfigurera Microsoft Antimalware för den virtuella datorn.

> [!NOTE]
>Azure Virtual Machines-konfigurationen för program mot skadlig kod stöder enbart konfiguration i JSON-format. Antimalware JSON-konfigurationsmall för inställningar som ingår i den [Microsoft program mot skadlig kod för Azure - kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure - kodexempel"), som visar stöds Inställningar för program mot skadlig kod.

### <a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>Aktivera och konfigurera program mot skadlig kod med hjälp av PowerShell-cmdlets

En Azure-program eller tjänst kan aktivera och konfigurera Microsoft Antimalware för Azure Cloud Services med PowerShell-cmdletar. Observera att Microsoft Antimalware är installerat i ett inaktiverat tillstånd i Cloud Services-plattformen och kräver en åtgärd av ett Azure-program så att den.

Aktivera och konfigurera Microsoft Antimalware med PowerShell-cmdletar:

1. Konfigurera din miljö för PowerShell - dokumentationen på <https://github.com/Azure/azure-sdk-tools#get-started>
2. Använd den [cmdlet Set-AzureServiceAntimalwareExtension program mot skadlig kod](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) aktivera och konfigurera Microsoft Antimalware för din molntjänst.

Antimalware XML-konfigurationsmall för inställningar som ingår i den [Microsoft program mot skadlig kod för Azure - kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure - kodexempel"), som visar stöds Inställningar för program mot skadlig kod.

### <a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>Molntjänster och virtuella datorer - konfiguration med hjälp av PowerShell-cmdletar

En Azure-program eller tjänst kan hämta Microsoft Antimalware-konfiguration för molntjänster och virtuella datorer med PowerShell-cmdletar.

Att hämta Microsoft Antimalware-konfigurationen med hjälp av PowerShell-cmdlets:

1. Konfigurera din miljö för PowerShell - dokumentationen på <https://github.com/Azure/azure-powershell>
2. **För virtuella datorer**: Använd den [cmdlet Get-AzureVMMicrosoftAntimalwareExtension program mot skadlig kod](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azurevmmicrosoftantimalwareextension) att hämta konfigurationen för program mot skadlig kod.
3. **För molntjänster**: Använd den [cmdlet Get-AzureServiceAntimalwareConfig program mot skadlig kod](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azureserviceantimalwareconfig) att hämta konfigurationen för program mot skadlig kod.

### <a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>Ta bort program mot skadlig kod konfigurationen med hjälp av PowerShell-cmdletar

En Azure-program eller tjänst du kan ta bort konfigurationen för program mot skadlig kod och alla associerade övervakningskonfigurationen för program mot skadlig kod från de relevanta Azure program mot skadlig kod och diagnostik tillägg som är associerade med Molntjänsten eller den virtuella datorn.

Ta bort Microsoft Antimalware med PowerShell-cmdletar:

1. Konfigurera din miljö för PowerShell - dokumentationen på <https://github.com/Azure/azure-powershell>
2. **För virtuella datorer**: Använd den [cmdlet Remove-AzureVMMicrosoftAntimalwareExtension program mot skadlig kod](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azurevmmicrosoftantimalwareextension).
3. **För molntjänster:** används den [cmdlet Remove-AzureServiceAntimalwareExtension program mot skadlig kod](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azureserviceantimalwareextension).

Att **aktivera** händelseinsamling för program mot skadlig kod för en virtuell dator med Azure Preview Portal:

1. Klicka på någon del av övervakning lins i bladet för virtuella datorn
2. Klicka på kommandot diagnostik på bladet mått
3. Välj **Status** på och markera alternativet för Windows event system
4. . Du kan välja att avmarkera alla andra alternativ i listan, eller lämna dem aktiveras per dina programbehov för tjänsten.
5. Program mot skadlig kod kategorier i ”Error”, ”varning”, ”information”, osv., fångas i Azure Storage-kontot.

Program mot skadlig kod händelser har samlats in från Windows-händelsesystemloggar till Azure Storage-kontot. Du kan konfigurera Storage-konto för den virtuella datorn att samla in händelser för program mot skadlig kod genom att välja lämpliga storage-konto.

![Mått och diagnostik](./media/azure-security-antimalware/sec-azantimal-fig8.PNG)

> [!NOTE]
> Mer information om hur du loggning av diagnostik för Azure program mot skadlig kod [aktivera diagnostik loggning för program mot skadlig kod Azure](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).

### <a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>Aktivera och konfigurera program mot skadlig kod övervakning med hjälp av powerShell-cmdletar

Du kan aktivera insamling av händelser för Microsoft Antimalware för din molntjänst eller virtuell dator med Azure Diagnostics via Antimalware PowerShell-cmdletar. Azure Diagnostics-tillägget kan konfigureras för att samla in händelser från käll-händelseloggen System ”Microsoft Antimalware” till Azure Storage-kontot. Program mot skadlig kod kategorier i ”Error”, ”varning”, ”information”, osv., fångas i Azure Storage-kontot.

Så här aktiverar händelseinsamling för program mot skadlig kod till ditt Azure Storage-konto med PowerShell-cmdlets:

1. Konfigurera din miljö för PowerShell - avser <https://github.com/Azure/azure-powershell>
2. **För virtuella datorer** – Använd den [cmdlet Set-AzureVMMicrosoftAntimalwareExtension program mot skadlig kod](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) med alternativet övervakning.
3. **För molntjänster** – Använd den [cmdlet Set-AzureServiceAntimalwareExtension program mot skadlig kod](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) med alternativet övervakning.

Du kan visa råhändelser för program mot skadlig kod genom att titta på den *WADWindowsEventLogsTable* tabell i Azure Storage-kontot som du har konfigurerat för att aktivera övervakning av program mot skadlig kod. Detta kan vara användbar för att kontrollera att händelseinsamling för program mot skadlig kod fungerar, inklusive hur du får insyn i program mot skadlig kod-tjänstens hälsa. Mer information, inklusive exempelkoden på hur man extraherar händelser för program mot skadlig kod från ditt lagringskonto finns i [Microsoft program mot skadlig kod för Azure - kodexempel](http://aka.ms/amazsamples "Microsoft program mot skadlig kod för Azure - kodexempel").
